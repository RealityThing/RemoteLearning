(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{133:function(e,t){},136:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(66),c=a.n(s),o=(a(18),a(3)),l=a(4),i=a(6),m=a(5),u=a(7),h=a(141),d=a(138),p=a(8),g=a(19),v=a(68),f=a(16),E=function(e){return void 0===e||null===e||"object"===typeof e&&0===Object.keys(e).length||"string"===typeof e&&0===e.trim().length},b={isAuthenticated:!1,user:{}},w={},N=Object(g.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return Object(f.a)({},e,{isAuthenticated:!E(t.payload),user:t.payload});default:return e}},errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return t.payload;case"CLEAR_ERRORS":return{};default:return e}},videos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_STREAM":var a=t.payload,n=a.stream;return e[a.user]=n,console.log("state",e),e;default:return e}}}),y=[v.a],S=Object(g.e)(N,{},Object(g.d)(g.a.apply(void 0,y))),C=a(24),O=a.n(C),j=a(11),k=a.n(j),x=function(e){e?k.a.defaults.headers.common.Authorization=e:delete k.a.defaults.headers.common.Authorization},I=function(e){return{type:"SET_CURRENT_USER",payload:e}},R=a(71),A=a(140),U=(Object(p.b)(function(e){return{auth:e.auth}})(function(e){var t=e.component,a=e.auth,n=Object(R.a)(e,["component","auth"]);return r.a.createElement(d.a,Object.assign({},n,{render:function(e){return!0===a.isAuthenticated?r.a.createElement(t,e):r.a.createElement(A.a,{to:"/login"})}}))}),a(139)),D=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).onLogoutClick=function(e){e.preventDefault(),a.props.logoutUser()},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.auth,t=e.isAuthenticated,a=e.user,n=r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(U.a,{className:"nav-link",to:"/"},"Learning Together")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(U.a,{to:"",className:"nav-link",onClick:this.onLogoutClick},r.a.createElement("img",{src:a.avatar,alt:a.name,className:"rounded-circle",style:{width:"25px",marginRight:"5px"},title:"You must have a Gravatar connected to your email to display an image"})," ","Log out"))),s=r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement("li",{className:"nav-item"},r.a.createElement(U.a,{className:"nav-link",to:"/register"},"Sign Up")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(U.a,{className:"nav-link",to:"/login"},"Login")));return r.a.createElement("nav",{className:"navbar navbar-expand-sm navbar-dark bg-dark mb-4"},r.a.createElement("div",{className:"container"},r.a.createElement(U.a,{className:"navbar-brand",to:"/"},"MERNQuick"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#mobile-nav"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse",id:"mobile-nav"},t?n:s)))}}]),t}(n.Component),T=(Object(p.b)(function(e){return{auth:e.auth}},{logoutUser:function(){return function(e){localStorage.removeItem("jwtToken"),x(!1),e(I({}))}}})(D),a(36),function(e){var t=e.name,a=e.placeholder,n=e.classes,s=e.value,c=e.icon,o=e.label,l=e.error,i=e.info,m=e.type,u=e.onChange,h=e.disabled;return r.a.createElement("div",{className:"input-field"},c&&r.a.createElement("i",{className:"material-icons prefix"},c),r.a.createElement("input",{type:m,className:"validate ".concat(n),placeholder:a,name:t,id:t,value:s,onChange:u,disabled:h}),o&&r.a.createElement("label",{for:t},o),l?r.a.createElement("span",{className:"helper-text invalid-feedback"}," ",l," "):i?r.a.createElement("span",{className:"helper-text"},i):null)});T.defaultProps={type:"text"};var _=T,P=a(23),q=a.n(P),M=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).onSubmit=function(e){e.preventDefault();var t=a.state,n=t.roomId,r=t.id,s={};if(E(n))return s.roomId="Please enter a valid room ID",void a.setState({errors:s});r=r||"none",k.a.get("/api/room/".concat(n,"/").concat(r)).then(function(e){console.log(e.data),a.props.history.push("/room/".concat(n))}).catch(function(e){console.log(e.response.data),e&&e.response&&e.response.data&&a.setState({errors:e.response.data})})},a.state={roomId:"",errors:{},id:!1},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("id");E(e)||this.setState({id:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"landing"},r.a.createElement("div",{className:"dark-overlay landing-inner mt-3"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"text-center"},r.a.createElement("div",{className:"center"},r.a.createElement("img",{src:q.a,className:"logo"}),r.a.createElement("div",{className:"info-msg"},r.a.createElement("span",null,"An interactive platform for schools, university or anyone!",r.a.createElement("br",null)," Ask questions and challenge others in real-time.",r.a.createElement("br",null)," No sign-up required, just create a room then send the link to others."))),r.a.createElement("div",{className:"row"},r.a.createElement("form",{noValidate:!0,onSubmit:this.onSubmit},r.a.createElement("div",{className:"col s12 m0 l3"}),r.a.createElement("div",{className:"col s12 m6 l3"},r.a.createElement(_,{type:"text",placeholder:"Paste room ID",name:"roomId",value:this.state.roomId,onChange:function(t){return e.setState({roomId:t.target.value})},error:this.state.errors.roomId})),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col btnt"},r.a.createElement("input",{type:"submit",value:"Enter Room",className:"btn btn-info btn-block mt-4"})),r.a.createElement("div",{className:"col btnt"},r.a.createElement(U.a,{to:"/create",className:"btn btn-lg btn-light"},"Create a room"))))))))))}}]),t}(n.Component),V=Object(p.b)(function(e){return{auth:e.auth}})(M),F=a(15),L=a(142),Y=function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(i.a)(this,Object(m.a)(t).call(this))).onChange=function(t){e.setState(Object(F.a)({},t.target.name,t.target.value))},e.onSubmit=function(t){t.preventDefault();var a={email:e.state.email,password:e.state.password};e.props.loginUser(a)},e.state={email:"",password:"",errors:{}},e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated&&this.props.history.push("/")}},{key:"componentWillReceiveProps",value:function(e){e.auth.isAuthenticated&&this.props.history.push("/"),e.errors&&this.setState({errors:e.errors})}},{key:"render",value:function(){var e=this.state.errors;return r.a.createElement("div",{className:"login"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-8 m-auto"},r.a.createElement("h1",{className:"display-4 text-center"},"Log In"),r.a.createElement("form",{noValidate:!0,onSubmit:this.onSubmit},r.a.createElement(_,{type:"email",label:"Email Address",name:"email",value:this.state.email,onChange:this.onChange,error:e.email}),r.a.createElement(_,{type:"password",label:"Password",name:"password",value:this.state.password,onChange:this.onChange,error:e.password}),r.a.createElement("input",{type:"submit",className:"btn btn-info btn-block mt-4"}),r.a.createElement(U.a,{to:"/register"},"Don't have an account? Register here"))))))}}]),t}(n.Component),W=(Object(p.b)(function(e){return{auth:e.auth,errors:e.errors}},{loginUser:function(e){return function(t){k.a.post("/api/user/login",e).then(function(e){var a=e.data.token;localStorage.setItem("jwtToken",a),x(a);var n=O()(a);console.log(n),t(I(n))}).catch(function(e){return t({type:"GET_ERRORS",payload:e.response.data})})}}})(Object(L.a)(Y)),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(i.a)(this,Object(m.a)(t).call(this))).onChange=function(t){e.setState(Object(F.a)({},t.target.name,t.target.value))},e.onSubmit=function(t){t.preventDefault();var a={first_name:e.state.first_name,last_name:e.state.last_name,email:e.state.email,password:e.state.password,password2:e.state.password2};e.props.registerUser(a,e.props.history)},e.state={first_name:"",last_name:"",email:"",password:"",password2:"",errors:{}},e}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.auth.isAuthenticated&&this.props.history.push("/")}},{key:"componentWillReceiveProps",value:function(e){e.errors&&this.setState({errors:e.errors})}},{key:"render",value:function(){var e=this.state.errors,t=this.props.auth.user;return r.a.createElement("div",{className:"register"},t?t.name:null,r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-8 m-auto"},r.a.createElement("h1",{className:"display-4 text-center"},"Sign Up"),r.a.createElement("form",{noValidate:!0,onSubmit:this.onSubmit},r.a.createElement(_,{label:"First name",name:"first_name",value:this.state.first_name,onChange:this.onChange,error:e.first_name}),r.a.createElement(_,{label:"Last name",name:"last_name",value:this.state.last_name,onChange:this.onChange,error:e.last_name}),r.a.createElement(_,{type:"email",label:"Email Address",name:"email",value:this.state.email,onChange:this.onChange,error:e.email}),r.a.createElement(_,{type:"password",label:"Password",name:"password",value:this.state.password,onChange:this.onChange,error:e.password}),r.a.createElement(_,{type:"password",label:"Confirm Password",name:"password2",value:this.state.password2,onChange:this.onChange,error:e.password2}),r.a.createElement("input",{type:"submit",className:"btn btn-info btn-block mt-4"}))))))}}]),t}(n.Component)),z=(Object(p.b)(function(e){return{auth:e.auth,errors:e.errors}},{registerUser:function(e,t){return function(t){k.a.post("/api/user/register",e).then(function(e){var a=e.data.token;localStorage.setItem("jwtToken",a),x(a);var n=O()(a);console.log(n),t(I(n))}).catch(function(e){return t({type:"GET_ERRORS",payload:e.response.data})})}}})(Object(L.a)(W)),a(2)),J=a.n(z),Q=a(10),Z=function(e){return Object.keys(e)},G=function(e,t,a){return a.findIndex(function(a){return a[t]==e})},B=function(e){return!E(e)&&{chars:(e=e.trim()).length,words:e.split(" ").length}},H=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).componentWillMount=Object(Q.a)(J.a.mark(function e(){var t,n,r;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("id"),n=localStorage.getItem("username"),r=localStorage.getItem("rooms"),E(r)){e.next=9;break}return e.next=6,JSON.parse(r);case 6:r=e.sent,console.log(r),a.setState({rooms:r});case 9:E(t)||a.setState({id:t}),E(n)||a.setState({username:n,storedUsername:n});case 11:case"end":return e.stop()}},e)})),a.onChange=function(e){a.setState(Object(F.a)({},e.target.name,e.target.value))},a.onSubmit=function(){var e=Object(Q.a)(J.a.mark(function e(t){var n,r,s,c,o,l,i,m,u;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=a.state,r=n.room,s=n.rooms,c=n.username,o=n.id,l=n.storedUsername,i={room:r,username:c,id:!E(o)&&o},m={},E(r)&&(m.room="Please enter a room name",a.setState({errors:m})),u=B(c),(E(c)||u&&u.chars<7||u.words<2)&&(m.username="Please enter your full name",a.setState({errors:m})),E(m)){e.next=9;break}return e.abrupt("return");case 9:k.a.post("/api/room",i).then(function(){var e=Object(Q.a)(J.a.mark(function e(t){return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&t.data&&t.data._id&&(console.log(t.data),l!=c&&(localStorage.setItem("username",c),a.setState({storedUsername:c,errors:m})),E(o)?localStorage.setItem("id",t.data.owner):o!=t.data.owner&&console.log("somethings wrong"),s.push(t.data._id),localStorage.setItem("rooms",JSON.stringify(s)),console.log(s),a.props.history.push("/room/".concat(t.data._id)));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){e&&e.response&&e.response.data&&a.setState({errors:e.response.data})});case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={room:"",id:"",username:"",storedUsername:"",errors:{},rooms:[]},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.errors&&this.setState({errors:e.errors})}},{key:"render",value:function(){var e=this,t=this.state,a=t.errors,n=t.username,s=t.room;return r.a.createElement("div",{className:"login landing"},r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-8 m-auto"},r.a.createElement("div",{className:"center"},r.a.createElement("img",{src:q.a,className:"logo"})),r.a.createElement("form",{noValidate:!0,onSubmit:this.onSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12 m0 l3"}),r.a.createElement("div",{className:"col s12 m6 l3"},r.a.createElement(_,{type:"text",placeholder:"Full Name",info:"This will be shown to the students",name:"username",value:n,onChange:function(t){return e.setState({username:t.target.value})},error:a.username})),r.a.createElement("div",{className:"col s12 m6 l3"},r.a.createElement(_,{type:"text",placeholder:"Class Name",info:"e.g CS-101-Class1",name:"room",value:s,onChange:this.onChange,error:a.room})),r.a.createElement("div",{className:"col btnt"},r.a.createElement("input",{type:"submit",value:"Create",className:"btn btn-info btn-block mt-4"}))))))))}}]),t}(n.Component),$=a(17),K=a(70),X=a.n(K),ee=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.challenge;return r.a.createElement("a",{href:"javascript:void(0);",className:"collection-item challenge",onClick:function(){return e.props.selectChallenge&&e.props.selectChallenge(t)}},r.a.createElement("div",{className:"header"},r.a.createElement("h5",null,t.name),t.comingSoon&&r.a.createElement("span",null,"Coming Soon")))}}]),t}(r.a.Component),te=a(30),ae=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"collection challenges"},te.map(function(t){return r.a.createElement(ee,Object.assign({key:t.id,challenge:t},e.props))}),r.a.createElement(ee,{challenge:{name:"Sketching",comingSoon:!0}}))}}]),t}(n.Component),ne=function(e){var t=e.name,a=e.placeholder,n=e.classes,s=e.value,c=e.icon,o=e.label,l=e.error,i=e.info,m=e.infoClass,u=e.onChange,h=e.disabled;return r.a.createElement("div",{className:"input-field"},c&&r.a.createElement("i",{className:"material-icons prefix"},c),r.a.createElement("textarea",{className:"materialize-textarea validate ".concat(n),placeholder:a,id:t,name:t,disabled:h,value:s,onChange:u}),o&&r.a.createElement("label",{className:E(s)?"":"active",for:t},o),l?r.a.createElement("span",{className:"helper-text invalid-feedback"}," ",l," "):i?r.a.createElement("span",{className:"helper-text ".concat(m)},i):null)},re=a(32),se=a.n(re),ce=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=document.querySelectorAll("select");se.a.FormSelect.init(e,{})}},{key:"render",value:function(){var e=this.props,t=e.name,a=e.value,n=e.defaultValue,s=e.label,c=e.error,o=e.info,l=e.onChange,i=e.options;return r.a.createElement("div",{className:"input-field"},r.a.createElement("select",{onChange:l,name:t,value:a},r.a.createElement("option",{value:"",disabled:!0,selected:!0},n),"timer"==t?[5,10,20,30,40,50,60].map(function(e){return r.a.createElement("option",{key:e,value:e},e," seconds")}):i.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})),s&&r.a.createElement("label",null,s),o&&r.a.createElement("small",{className:"form-text text-mutated"},o),c&&r.a.createElement("div",{className:"invalid-feedback"}," ",c," "))}}]),t}(r.a.Component),oe=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).answerStatus=function(e,t){return e in t.participants?t.participants[e]==t.answer?"correct":t.answer.includes(t.participants[e])?"close":"not quite":"hmmm. something went wrong"},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.myId,a=(e.users,e.challenge);return r.a.createElement("div",null,r.a.createElement("ul",{className:"collection with-header"},r.a.createElement("li",{className:"collection-header"},r.a.createElement("h4",{className:"heading"},a.question),r.a.createElement("h5",{className:"me"},"Answer: ",a.answer),r.a.createElement("span",null,"".concat(a.participants.length," participant").concat(a.participants.length>1?"s":""))),a.participants.map(function(e){return r.a.createElement("li",{className:"collection-item ".concat(e.id==t&&"my-answer")},r.a.createElement("p",null,e.name," answered: ",null===e.answer?"loading...":E(e.answer)?"none":e.answer))})))}}]),t}(r.a.Component),le=function(e){var t=e.choices,a=e.name,n=e.classes,s=e.error,c=e.info,o=e.infoClass,l=e.onChange,i=e.disabled,m=e.selectedChoice;return console.log(m,t),r.a.createElement("div",{className:"input-field"},r.a.createElement("div",{className:"row center"},t.map(function(e){return r.a.createElement("label",null,r.a.createElement("input",{className:"with-gap ".concat(n),disabled:i,name:a,type:"radio",value:e,onChange:l,checked:m==e}),r.a.createElement("span",{className:"radiolabel"},e))})),r.a.createElement("div",{className:"row"},s?r.a.createElement("span",{className:"helper-text invalid-feedback"}," ",s," "):c?r.a.createElement("span",{className:"helper-text ".concat(o)},c):null))},ie=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.myId,a=e.users,n=e.room,s=e.challenge,c=e.errors,o=e.countDown,l=e.clearChoices,i=e.addChoice,m=e.showChallenges,u=e.challengeStatus,h=e.selectChallenge,d=e.onEditChallenge,p=e.startChallenge,g=e.setChallengeStatus;return r.a.createElement(r.a.Fragment,null,"wait"==u&&m?r.a.createElement(ae,{selectChallenge:h}):"edit"==u?r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",null,s.name),r.a.createElement("form",{noValidate:!0,onSubmit:function(e){e.preventDefault()}},r.a.createElement(ne,{type:"text",label:"Question",name:"question",error:c.question,value:s.question,onChange:d}),"Q&A"==s.type?r.a.createElement(ne,{type:"text",label:"Answer (this will not be shown to the students)",name:"answer",error:c.answer,value:s.answer,onChange:d}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s8"},r.a.createElement(ne,{type:"text",label:"Add a choice",name:"choice",error:c.choice,value:s.choice,onChange:d})),r.a.createElement("div",{className:"col"},r.a.createElement("button",{onClick:i,className:"btn btnt btn-small"}," Add choice")),r.a.createElement("br",null),r.a.createElement("a",{onClick:l,href:"javascript:void(0);",className:"link-dash"},"Clear")),r.a.createElement(le,{selectedChoice:s.answer,choices:s.choices,name:"answer",error:c.answer,onChange:d})),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6"},r.a.createElement(ne,{type:"text",label:"Info (optional)",name:"info",value:s.info,onChange:d})),r.a.createElement("div",{className:"col s6"},r.a.createElement(ce,{name:"timer",label:"Timer",value:s.timer,defaultValue:"Select a timer",onChange:d}))),r.a.createElement("div",{className:"col"},r.a.createElement("input",{onClick:p,type:"submit",value:"Begin Challenge",className:"btn btn-primary"})),r.a.createElement("div",{className:"col"},r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return h(null)}},"Cancel")))):"start"==u?r.a.createElement(r.a.Fragment,null,o>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"heading"},"Challenge starting in ",o)):r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"heading"},s.question),r.a.createElement("span",null,"".concat(s.participants.length," participant").concat(s.participants.length>1?"s":""," - ").concat(s.timer," second").concat(s.timer>1?"s":""," left")))):"complete"==u?r.a.createElement(r.a.Fragment,null,r.a.createElement(oe,{myId:t,users:a,challenge:s}),r.a.createElement("button",{className:"btn btn-primary",onClick:function(){return g("wait")}},"New Challenge")):null,m&&"wait"!=u&&"edit"!=u?null:r.a.createElement("div",{className:"send-link-section"},r.a.createElement("span",null,"Send this link to your students so they can join the room."),r.a.createElement("br",null),r.a.createElement("a",{className:"link",target:"_blank",href:"http://localhost:3000/room/".concat(n._id)},"http://learningtogether.com/room/".concat(n._id))))}}]),t}(r.a.Component),me=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.myId,a=e.users,n=e.countDown,s=e.errors,c=e.sendAnswer,o=e.answerSent,l=e.challenge,i=e.challengeStatus,m=e.onEditChallenge;return r.a.createElement(r.a.Fragment,null,"wait"==i?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"You will be notified when the owner creates a challenge.")):"start"==i?r.a.createElement(r.a.Fragment,null,n>0?r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"heading"},"Challenge starting in ",n)):r.a.createElement(r.a.Fragment,null,r.a.createElement("h4",{className:"heading"},l.question),r.a.createElement("span",null,"".concat(l.participants.length," participant").concat(l.participants.length>1?"s":""," - ").concat(l.timer," second").concat(l.timer>1?"s":""," left")),r.a.createElement("form",{noValidate:!0,onSubmit:c},"Q&A"==l.type?r.a.createElement(ne,{type:"text",label:"Type out your answer",name:"studentAnswer",disabled:o,error:s.studentAnswer,value:l.studentAnswer,info:!!o&&"Your answer has been recorded.",infoClass:"me",onChange:function(e){return m(e,"participant")}}):r.a.createElement("div",{className:"row center"},r.a.createElement(le,{selectedChoice:l.studentAnswer,choices:l.choices,name:"studentAnswer",error:s.studentAnswer,disabled:o,info:!!o&&"Your answer has been recorded.",infoClass:"me",onChange:function(e){return m(e,"participant")}})),r.a.createElement("input",{type:"submit",value:"Send answer",disabled:o,className:"btn btn-primary"})))):"complete"==i?r.a.createElement(oe,{myId:t,users:a,challenge:l}):null)}}]),t}(r.a.Component),ue=function(){return r.a.createElement("div",{className:"col loader center"},r.a.createElement("div",{className:"preloader-wrapper big active center"},r.a.createElement("div",{className:"spinner-layer spinner-blue-only"},r.a.createElement("div",{className:"circle-clipper left"},r.a.createElement("div",{className:"circle"})),r.a.createElement("div",{className:"gap-patch"},r.a.createElement("div",{className:"circle"})),r.a.createElement("div",{className:"circle-clipper right"},r.a.createElement("div",{className:"circle"})))))},he=function(e){var t=e.username,a=e.changeUsername,n=e.setUsername,s=e.errors,c=e.room;return r.a.createElement("div",{className:"col-md-12 text-center"},r.a.createElement("div",{className:"center"},r.a.createElement("img",{src:q.a,className:"logo"}),r.a.createElement("h4",{className:"joining"},"Joining ",c.name)),r.a.createElement("div",{className:"row"},r.a.createElement("form",{noValidate:!0,onSubmit:n},r.a.createElement("div",{className:"col s4"}),r.a.createElement("div",{className:"col s3"},r.a.createElement(_,{type:"text",placeholder:"Enter your full name to join the room",name:"username",value:t,onChange:a,error:s.username})),r.a.createElement("div",{className:"col btnt"},r.a.createElement("input",{type:"submit",value:"Enter",className:"btn btn-primary"})))))},de=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).componentDidMount=Object(Q.a)(J.a.mark(function e(){var t,n,r,s,c,o,l;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.validateRoomId();case 2:t=a.state,n=t.loading,r=t.inValidId,s=t.room,c=t.userIsSet,n||r||E(s)||(o=X()(),console.log("socket",o),a.setState({socket:o},function(){return c&&a.socketEvents(o)})),l=document.querySelectorAll(".tooltipped"),se.a.Tooltip.init(l,{});case 6:case"end":return e.stop()}},e)})),a.socketEvents=function(){var e=Object(Q.a)(J.a.mark(function e(t){return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.newUser(t),a.getUsers(t),a.userJoined(t),a.getNewMessages(t),a.userLeft(t),a.getChallenge(t),a.getParticipants(t),a.nameChange(t),a.leaveRoom(t);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.validateRoomId=function(){var e=Object(Q.a)(J.a.mark(function e(t){var n,r,s,c,o,l,i,m;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.props.match.params.id,!E(n)){e.next=4;break}return a.setState({inValidId:!0}),e.abrupt("return");case 4:if(r=localStorage.getItem("rooms"),s=localStorage.getItem("id"),c=localStorage.getItem("username"),E(r)){e.next=13;break}return e.next=10,JSON.parse(r);case 10:r=e.sent,e.next=14;break;case 13:r=[];case 14:return o=!1,l="",E(c)?l="":(l=c,o=!0),a.setState({id:s,username:l,userIsSet:o,storedUsername:c,rooms:r}),s=s||"none",e.next=21,k.a.get("/api/room/".concat(n,"/").concat(s));case 21:i=e.sent;try{console.log(i.data),i&&i.data&&i.data.success?(m=!1,s&&s==i.data.room.owner&&(m=!0),console.log("isOwner",m),o&&a.saveRoom(i.data.room),a.setState({inValidId:!1,loading:!1,isOwner:m,room:i.data.room})):console.log(2)}catch(t){console.log(t.response.data),a.setState({inValidId:!0,loading:!1})}case 23:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.newUser=function(){var e=Object(Q.a)(J.a.mark(function e(t){var n,r,s,c;return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.state,r=n.room,s=n.username,c=n.id,t.emit("new-user",r._id,s,r.owner==c);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.getUsers=function(){var e=Object(Q.a)(J.a.mark(function e(t){return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.on("get-users",function(e){a.setState({users:e},function(){0===a.state.messages.length&&a.showOwnerTag()})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.showOwnerTag=function(){var e=a.state.messages,t=a.getOwner("name");if(t){var n=r.a.createElement("div",{className:"small-text"},r.a.createElement("strong",{className:"owner"},t)," is the owner"),s=Object($.a)(e);s[0]=n,console.log(s),a.setState({messages:s})}},a.userJoined=function(){var e=Object(Q.a)(J.a.mark(function e(t){return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.on("user-joined",function(e){var t=[r.a.createElement("strong",{className:"other"},e)," has joined the room"];a.setState({messages:[].concat(Object($.a)(a.state.messages),[t])})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.sendMessage=function(e){e.preventDefault(),E(a.state.message)||(a.state.socket.emit("send-message",a.state.message),a.setState({message:""}))},a.changeUsername=function(e){return a.setState({username:e.target.value})},a.setUsername=function(e){e.preventDefault();var t=a.state,n=t.socket,r=t.username,s=t.storedUsername,c=t.userIsSet,o=t.room,l=t.changeUsername,i={},m=B(r);if(E(r)||m&&m.chars<7||m.words<2)return i.username="Please enter your full name",void a.setState({errors:i});r!=s&&(localStorage.setItem("username",r),a.setState({storedUsername:r})),c?l&&(n.emit("name-change",r),a.setState({changeUsername:!1})):(a.saveRoom(o),a.setState({userIsSet:!0,errors:i},function(){return a.socketEvents(n)}))},a.saveRoom=function(e){var t=a.state.rooms;t.includes(e._id)||(a.setState({rooms:[].concat(Object($.a)(t),[e._id])}),localStorage.setItem("rooms",JSON.stringify(t)))},a.getNewMessages=function(){var e=Object(Q.a)(J.a.mark(function e(t){return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.on("new-message",function(e){var n=a.state.messages,s=[r.a.createElement("strong",{className:e.id==t.id?"me":e.id==a.getOwner()?"owner":"other"},e.username),": "+e.message],c=Object($.a)(n);c.length>=25&&c.splice(1,1),c.push(s),a.setState({messages:c})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.userLeft=function(){var e=Object(Q.a)(J.a.mark(function e(t){return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.on("user-left",function(e){var t=a.state,n=t.users,s=t.recentLeavers,c=[r.a.createElement("strong",{className:"other"},n[e].name)," has left the room"];s.includes(e)||a.setState({recentLeavers:[].concat(Object($.a)(s),[e])}),a.setState({messages:[].concat(Object($.a)(a.state.messages),[c])})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.nameChange=function(){var e=Object(Q.a)(J.a.mark(function e(t){return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.on("get-name-change",function(e,n,s){var c=a.state,o=c.messages,l=c.isOwner,i=s==a.getOwner()&&!l?"owner":t.id==s?"me":"other",m=[r.a.createElement("strong",{className:i},t.id==s?"You":e)," changed ".concat(t.id==s?"your":"their"," name to "),r.a.createElement("strong",{className:i},n)];a.setState({messages:[].concat(Object($.a)(o),[m])})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.closeRoom=function(){var e=a.state,t=e.room,n=e.id,r=e.socket;if(n&&n==t.owner){if(!window.confirm("This will kick all the users and close the room, you may re-open the room again by going to the same URL. Are you sure you want to procced?"))return;r.emit("close-room")}},a.leaveRoom=function(){var e=Object(Q.a)(J.a.mark(function e(t){return J.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.on("leave-room",function(){a.setState({roomEnded:!0})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.typing=function(e){a.setState({message:e.target.value})},a.selectChallenge=function(e){a.setState({challenge:Object(f.a)({},e,{owner:a.state.socket.id}),challengeStatus:null==e?"wait":"edit"})},a.onEditChallenge=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.target,r=n.name,s=n.value;a.setState({challenge:Object(f.a)({},a.state.challenge,Object(F.a)({},r,s))},function(){var e=a.state,n=e.socket,c=e.challenge,o=e.hasParticipated;if("participant"==t){if(console.log(r,s),o)return;a.setState({hasParticipated:!0}),-1===G(n.id,"id",c.participants)&&n.emit("new-participant",c)}})},a.addChoice=function(){var e=a.state.challenge,t={};E(e.choice)?t.choice="You must add a choice":e.choices.includes(e.choice)?t.choice="This choice is already added":e.choices.length>7&&(t.choice="Too many choices."),Z(t).length>0?a.setState({errors:t}):a.setState({errors:t,challenge:Object(f.a)({},e,{choices:[].concat(Object($.a)(e.choices),[e.choice]),choice:""})})},a.getParticipants=function(e){e.on("get-participants",function(e,t){console.log("participants",e),a.setState({challenge:Object(f.a)({},a.state.challenge,{participants:e})})})},a.startChallenge=function(e){e.preventDefault();var t=a.state,n=t.socket,r=t.challenge,s=t.users,c={};if(E(r.question)&&(c.question="Question field cannot be empty"),E(r.answer)&&("Q&A"==r.type?c.answer="Answer field cannot be empty":r.choices.length>1&&(c.answer="You must select the correct answer")),"MC"==r.type&&r.choices.length<2&&(c.choice="You must add atleast 2 choices"),Z(c).length)a.setState({errors:c});else if(1===Z(s).length&&n.id in s)window.alert("There are no students in the room, send them the link so they can join.");else{var o=Object(f.a)({},r,{question:r.question.trim(),answer:r.answer.trim()});console.log(o.answer),window.confirm("There is ".concat(Z(s).length-1," student").concat(Z(s).length-1>1?"s":""," in the room, do you want to begin the challenge now?"))&&a.setState({errors:c,challenge:o,challengeStatus:"start",countDown:5},function(){a.newChallenge(n,a.state.challenge),a.initTimer()})}},a.newChallenge=function(e,t){e.emit("new-challenge",t)},a.getChallenge=function(e){e.on("get-challenge",function(e){a.setState({challenge:e,challengeStatus:"start",countDown:5},function(){return a.initTimer()})})},a.initTimer=function(){a.countDownIsZero=setInterval(a.countDown,1e3)},a.countDown=function(){var e=a.state.countDown;e>0?(e-=1,a.setState({countDown:e})):(clearInterval(a.countDownIsZero),a.timerReachedZero=setInterval(a.challengeTimer,1e3))},a.challengeTimer=function(){var e=a.state,t=e.challenge,n=(e.socket,t.timer);n>1?(n-=1,a.setState({challenge:Object(f.a)({},a.state.challenge,{timer:n})})):(clearInterval(a.timerReachedZero),a.timerReachedZero=null,a.challengeCompleted())},a.sendAnswer=function(e){e.preventDefault();var t=a.state,n=t.socket,r=t.challenge;if(E(r.studentAnswer))a.setState({errors:{studentAnswer:"Q&A"==r.type?"You must provide an answer":"You must select an answer"}});else{a.setState({errors:{}});var s=r.studentAnswer.trim();a.setState({answerSent:!0}),n.id!=r.owner&&n.emit("send-answer",r.id,s)}},a.challengeCompleted=function(){var e=a.state;e.socket,e.challenge;console.log("completed"),a.setState({answerSent:!1,hasParticipated:!1}),a.setState({challengeStatus:"complete"})},a.setChallengeStatus=function(e){"wait"!=e&&"edit"!=e&&"start"!=e&&"complete"!=e||a.setState({challengeStatus:e})},a.getOwner=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=a.state.users,n=Z(t).filter(function(e){return t[e].owner});return!(!n||!n.length)&&(e?t[n[0]].name:n[0])},a.clearChoices=function(){var e=a.state.challenge;e&&a.setState({challenge:Object(f.a)({},e,{choices:[],answer:""})})},a.state={room:{},rooms:[],socket:null,stream:null,roomEnded:!1,loading:!0,inValidId:!1,userIsSet:!1,errors:{},id:"",username:"",storedUsername:"",isOwner:!1,changeUsername:!1,challengeStatus:"wait",challenge:null,showChallenges:!1,countDown:0,countDownStarting:!0,hasParticipated:!1,answerSent:!1,users:{},recentLeavers:[],messages:[],message:"",localVideoRef:r.a.createRef(),user_streams:{}},a.timerReachedZero=null,a.countDownIsZero=null,a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.showChallenges,n=t.username,s=t.roomEnded,c=t.answerSent,o=t.changeUsername,l=t.errors,i=t.room,m=t.socket,u=t.loading,h=t.inValidId,d=t.users,p=t.messages,g=t.userIsSet,v=t.isOwner,f=t.countDown,E=t.challenge,b=t.challengeStatus,w=t.challengeResults;return r.a.createElement("div",{className:"row"},u?r.a.createElement(ue,null):h?"Invalid ID":!g||o?r.a.createElement(he,{username:n,changeUsername:this.changeUsername,setUsername:this.setUsername,errors:l,room:i}):s?r.a.createElement(r.a.Fragment,null,v?r.a.createElement("p",null,"You have closed the room."):r.a.createElement("p",null,"Room has ended.")):r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s8 nav"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s3 m6 l8"},r.a.createElement("h4",null,i.name),r.a.createElement("span",null,"Hi ",n," "),r.a.createElement("div",null,r.a.createElement("a",{className:"link-dash",onClick:function(){return e.setState({changeUsername:!0})},href:"javascript:void(0);"},"Change username")),r.a.createElement("div",null,r.a.createElement("a",{className:"red-color link-dash",onClick:function(){return e.closeRoom()},href:"javascript:void(0);"},"Close room")),r.a.createElement("br",null),r.a.createElement("span",null,"Users: ",Z(d).length)),v&&r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"top-create-btn"},r.a.createElement("a",{className:"btn",onClick:function(){return e.setState({challengeStatus:"wait",showChallenges:!0})}},r.a.createElement("i",{className:"material-icons right"},"add"),"new challenge"))),r.a.createElement("div",{className:"col"},r.a.createElement("div",{className:"top-create-btn"},r.a.createElement("a",{className:"btn whiteboardbtn tooltipped","data-position":"bottom","data-tooltip":"Coming soon"},r.a.createElement("i",{className:"material-icons right"},"dashboard"),"Whiteboard")))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s8 mainArea"},r.a.createElement("div",{className:"center"},v?r.a.createElement(ie,{challenge:E,errors:l,addChoice:this.addChoice,clearChoices:this.clearChoices,room:i,showChallenges:a,myId:m&&m.id,users:d,countDown:f,challengeStatus:b,selectChallenge:this.selectChallenge,onEditChallenge:this.onEditChallenge,startChallenge:this.startChallenge,challengeResults:w,setChallengeStatus:this.setChallengeStatus}):r.a.createElement(me,{challenge:E,errors:l,answerSent:c,sendAnswer:this.sendAnswer,myId:m&&m.id,users:d,onEditChallenge:this.onEditChallenge,countDown:f,challengeStatus:b,challengeResults:w,setChallengeStatus:this.setChallengeStatus}))))),r.a.createElement("div",{className:"col s4"},r.a.createElement("div",{className:"card-panel messenger"},r.a.createElement("h5",null,"Messenger"),r.a.createElement("div",{className:"chat",id:"chat"},p.map(function(e,t){return r.a.createElement("div",{key:t,className:"small-text"},e)})),r.a.createElement("form",{noValidate:!0,onSubmit:this.sendMessage},r.a.createElement(_,{type:"text",placeholder:"Write a message",name:"message",classes:"input-text",value:this.state.message,onChange:this.typing}),r.a.createElement("input",{type:"submit",value:"Send",className:"btn btn-primary"}))),i&&r.a.createElement("a",{href:"/room/".concat(i._id)},r.a.createElement("span",{className:"small-text link-dash"},"Refresh room if you are experiencing issues.")))))}}]),t}(n.Component),pe=Object(p.b)(function(e){return{auth:e.auth,profile:e.profile,videos:e.videos}},{setStream:function(e,t){return{type:"SET_STREAM",payload:{stream:e,user:t}}}})(Object(L.a)(de)),ge=function(){return r.a.createElement("div",{class:"footer"},r.a.createElement("div",{className:"left"},r.a.createElement("a",{className:"white-text",href:"mailto:sam@realitything.com"}," ",r.a.createElement("span",{className:"small-text"},"Contact Us"))),r.a.createElement("span",{className:"small-text"},"@ 2020 Remote Learning "),r.a.createElement("div",{className:"right"},r.a.createElement("span",{className:"small-text"}," Developed by RealityThing ")))};if(localStorage.jwtToken){x(localStorage.jwtToken);var ve=O()(localStorage.jwtToken);S.dispatch(I(ve))}var fe=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,{store:S},r.a.createElement(h.a,null,r.a.createElement("div",{className:"App container"},r.a.createElement(d.a,{exact:!0,path:"/",component:V}),r.a.createElement(d.a,{exact:!0,path:"/create",component:H}),r.a.createElement(d.a,{exact:!0,path:"/room/:id",component:pe}))),r.a.createElement(ge,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},18:function(e,t,a){},23:function(e,t,a){e.exports=a.p+"static/media/logo.9911fc78.png"},30:function(e){e.exports=[{id:1,name:"Question and Answer",description:"Ask the students a question and they will answer it.",type:"Q&A",question:"What is the name of the Greek dip consisting of yoghurt and cucumber?",answer:"Tzatziki",info:"",timer:10,studentAnswer:"",participants:[]},{id:2,name:"Multiple Choice",description:"Give the students options to answer a question.",type:"MC",question:"Which of the following geological eras came first",answer:"Paleozoic",choices:["Mesozoic","Paleozoic","Cenozoic"],choice:"",info:"",timer:10,studentAnswer:"",participants:[]}]},72:function(e,t,a){e.exports=a(136)}},[[72,2,1]]]);
//# sourceMappingURL=main.461a9951.chunk.js.map